var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||'function'==typeof Object.defineProperties?Object.defineProperty:function(a,b,e){a!=Array.prototype&&a!=Object.prototype&&(a[b]=e.value)};$jscomp.getGlobal=function(a){return'undefined'!=typeof window&&window===a?a:'undefined'!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX='jscomp_symbol_';
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||'')+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol('iterator'));'function'!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new $jscomp.global.Proxy(a,{get:function(e,c,f){return e==a&&'q'==c&&f==b}}));return!0===b.q}catch(e){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();
$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};$jscomp.polyfill=function(a,b,e,c){if(b){e=$jscomp.global;a=a.split('.');for(c=0;c<a.length-1;c++){var f=a[c];f in e||(e[f]={});e=e[f]}a=a[a.length-1];c=e[a];b=b(c);b!=c&&null!=b&&$jscomp.defineProperty(e,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill('WeakMap',function(a){function b(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),f=new a([[b,2],[c,3]]);if(2!=f.get(b)||3!=f.get(c))return!1;f.delete(b);f.set(c,4);return!f.has(b)&&4==f.get(c)}catch(k){return!1}}function e(a){$jscomp.owns(a,f)||$jscomp.defineProperty(a,f,{value:{}})}function c(a){var b=Object[a];b&&(Object[a]=function(a){e(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;
var f='$jscomp_hidden_'+Math.random();c('freeze');c('preventExtensions');c('seal');var g=0,h=function(a){this.id_=(g+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};h.prototype.set=function(a,b){e(a);if(!$jscomp.owns(a,f))throw Error('WeakMap key fail: '+a);a[f][this.id_]=b;return this};h.prototype.get=function(a){return $jscomp.owns(a,f)?a[f][this.id_]:void 0};h.prototype.has=
function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)};h.prototype.delete=function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)?delete a[f][this.id_]:!1};return h},'es6','es3');$jscomp.checkStringArgs=function(a,b,e){if(null==a)throw new TypeError("The 'this' value for String.prototype."+e+' must not be null or undefined');if(b instanceof RegExp)throw new TypeError('First argument to String.prototype.'+e+' must not be a regular expression');return a+''};
$jscomp.polyfill('String.prototype.repeat',function(a){return a?a:function(a){var b=$jscomp.checkStringArgs(this,null,'repeat');if(0>a||1342177279<a)throw new RangeError('Invalid count value');a|=0;for(var c='';a;)if(a&1&&(c+=b),a>>>=1)b+=b;return c}},'es6','es3');$jscomp.assign='function'==typeof Object.assign?Object.assign:function(a,b){for(var e=1;e<arguments.length;e++){var c=arguments[e];if(c)for(var f in c)$jscomp.owns(c,f)&&(a[f]=c[f])}return a};
$jscomp.polyfill('Object.assign',function(a){return a||$jscomp.assign},'es6','es3');$jscomp.polyfill('Number.EPSILON',function(a){return Math.pow(2,-52)},'es6','es3');$jscomp.polyfill('Number.MAX_SAFE_INTEGER',function(){return 9007199254740991},'es6','es3');
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+='');var e=0,c={next:function(){if(e<a.length){var f=e++;return{value:b(f,a[f]),done:!1}}c.next=function(){return{done:!0,value:void 0}};return c.next()}};c[Symbol.iterator]=function(){return c};return c};$jscomp.polyfill('Array.prototype.keys',function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},'es6','es3');
$jscomp.polyfill('Math.sign',function(a){return a?a:function(a){a=Number(a);return 0===a||isNaN(a)?a:0<a?1:-1}},'es6','es3');$jscomp.polyfill('Array.prototype.values',function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,e){return e})}},'es8','es3');$jscomp.polyfill('Number.isFinite',function(a){return a?a:function(a){return'number'!==typeof a?!1:!isNaN(a)&&Infinity!==a&&-Infinity!==a}},'es6','es3');
$jscomp.polyfill('Number.isInteger',function(a){return a?a:function(a){return Number.isFinite(a)?a===Math.floor(a):!1}},'es6','es3');$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill('Promise',function(a){function b(){this.batch_=null}function e(a){return a instanceof f?a:new f(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};b.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var c=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){c(a,
0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];delete a[b];try{c()}catch(p){this.asyncThrow_(p)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var f=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(l){b.reject(l)}};f.prototype.createResolveAndReject_=
function(){function a(a){return function(f){c||(c=!0,a.call(b,f))}}var b=this,c=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};f.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError('A Promise cannot resolve to itself'));else if(a instanceof f)this.settleSameAsPromise_(a);else{a:switch(typeof a){case 'object':var b=null!=a;break a;case 'function':b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};f.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(l){this.reject_(l);return}'function'==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};f.prototype.reject_=function(a){this.settle_(2,a)};f.prototype.fulfill_=function(a){this.settle_(1,a)};f.prototype.settle_=function(a,b){if(0!=this.state_)throw Error('Cannot settle('+a+', '+b|'): Promise already settled in state'+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};f.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
this.onSettledCallbacks_,b=0;b<a.length;++b)a[b].call(),a[b]=null;this.onSettledCallbacks_=null}};var g=new b;f.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};f.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(p){c.reject(p)}};f.prototype.then=function(a,b){function c(a,b){return'function'==typeof a?function(b){try{e(a(b))}catch(x){g(x)}}:b}var e,g,d=new f(function(a,
b){e=a;g=b});this.callWhenSettled_(c(a,e),c(b,g));return d};f.prototype.catch=function(a){return this.then(void 0,a)};f.prototype.callWhenSettled_=function(a,b){function c(){switch(f.state_){case 1:a(f.result_);break;case 2:b(f.result_);break;default:throw Error('Unexpected state: '+f.state_);}}var f=this;null==this.onSettledCallbacks_?g.asyncExecute(c):this.onSettledCallbacks_.push(function(){g.asyncExecute(c)})};f.resolve=e;f.reject=function(a){return new f(function(b,c){c(a)})};f.race=function(a){return new f(function(b,
c){for(var f=$jscomp.makeIterator(a),g=f.next();!g.done;g=f.next())e(g.value).callWhenSettled_(b,c)})};f.all=function(a){var b=$jscomp.makeIterator(a),c=b.next();return c.done?e([]):new f(function(a,f){function d(b){return function(d){g[b]=d;h--;0==h&&a(g)}}var g=[],h=0;do g.push(void 0),h++,e(c.value).callWhenSettled_(d(g.length-1),f),c=b.next();while(!c.done)})};return f},'es6','es3');
$jscomp.polyfill('Array.prototype.fill',function(a){return a?a:function(a,e,c){var b=this.length||0;0>e&&(e=Math.max(0,b+e));if(null==c||c>b)c=b;c=Number(c);0>c&&(c=Math.max(0,b+c));for(e=Number(e||0);e<c;e++)this[e]=a;return this}},'es6','es3');
$jscomp.polyfill('String.prototype.endsWith',function(a){return a?a:function(a,e){var b=$jscomp.checkStringArgs(this,a,'endsWith');a+='';void 0===e&&(e=b.length);e=Math.max(0,Math.min(e|0,b.length));for(var f=a.length;0<f&&0<e;)if(b[--e]!=a[--f])return!1;return 0>=f}},'es6','es3');
$jscomp.polyfill('String.prototype.startsWith',function(a){return a?a:function(a,e){var b=$jscomp.checkStringArgs(this,a,'startsWith');a+='';var f=b.length,g=a.length;e=Math.max(0,Math.min(e|0,b.length));for(var h=0;h<g&&e<f;)if(b[e++]!=a[h++])return!1;return h>=g}},'es6','es3');$jscomp.polyfill('Object.is',function(a){return a?a:function(a,e){return a===e?0!==a||1/a===1/e:a!==a&&e!==e}},'es6','es3');
$jscomp.polyfill('Array.prototype.includes',function(a){return a?a:function(a,e){var b=this;b instanceof String&&(b=String(b));var f=b.length;for(e=e||0;e<f;e++)if(b[e]==a||Object.is(b[e],a))return!0;return!1}},'es7','es3');$jscomp.polyfill('String.prototype.includes',function(a){return a?a:function(a,e){return-1!==$jscomp.checkStringArgs(this,a,'includes').indexOf(a,e||0)}},'es6','es3');
$jscomp.findInternal=function(a,b,e){a instanceof String&&(a=String(a));for(var c=a.length,f=0;f<c;f++){var g=a[f];if(b.call(e,g,f,a))return{i:f,v:g}}return{i:-1,v:void 0}};$jscomp.polyfill('Array.prototype.find',function(a){return a?a:function(a,e){return $jscomp.findInternal(this,a,e).v}},'es6','es3');$jscomp.MapEntry=function(){};
$jscomp.polyfill('Map',function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||'function'!=typeof a||!a.prototype.entries||'function'!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([[b,'s']]));if('s'!=c.get(b)||1!=c.size||c.get({x:4})||c.set({x:4},'t')!=c||2!=c.size)return!1;var f=c.entries(),d=f.next();if(d.done||d.value[0]!=b||'s'!=d.value[1])return!1;d=f.next();return d.done||4!=d.value[0].x||'t'!=d.value[1]||!f.next().done?!1:!0}catch(n){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbol();$jscomp.initSymbolIterator();var e=new WeakMap,c=function(a){this.data_={};this.head_=h();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};c.prototype.set=function(a,b){var c=f(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:a,value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};c.prototype.delete=function(a){a=f(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};c.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=h();this.size=0};c.prototype.has=function(a){return!!f(this,a).entry};
c.prototype.get=function(a){return(a=f(this,a).entry)&&a.value};c.prototype.entries=function(){return g(this,function(a){return[a.key,a.value]})};c.prototype.keys=function(){return g(this,function(a){return a.key})};c.prototype.values=function(){return g(this,function(a){return a.value})};c.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};c.prototype[Symbol.iterator]=c.prototype.entries;var f=function(a,b){var c=b&&typeof b;'object'==
c||'function'==c?e.has(b)?c=e.get(b):(c=''+ ++m,e.set(b,c)):c='p_'+b;var d=a.data_[c];if(d&&$jscomp.owns(a.data_,c))for(a=0;a<d.length;a++){var f=d[a];if(b!==b&&f.key!==f.key||b===f.key)return{id:c,list:d,index:a,entry:f}}return{id:c,list:d,index:-1,entry:void 0}},g=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},h=function(){var a={};return a.previous=
a.next=a.head=a},m=0;return c},'es6','es3');$jscomp.polyfill('Number.parseFloat',function(a){return a||parseFloat},'es6','es3');function Nunu(){}Nunu.NAME='nunuStudio';Nunu.VERSION='V0.9.4 Beta';Nunu.TIMESTAMP='201803311723';Nunu.webvrAvailable=function(){return void 0!==navigator.getVRDisplays};Nunu.getVRDisplays=function(a){void 0===navigator.getVRDisplays?console.warn('nunuStudio: WebVR is not supported.'):navigator.getVRDisplays().then(function(b){0<b.length?a(b[0]):console.warn('nunuStudio: WebVR supported but no display is available.')})};
Nunu.webAudioAvailable=function(){return void 0!==window.AudioContext||void 0!==window.webkitAudioContext};Nunu.webglAvailable=function(){try{var a=document.createElement('canvas');(a.getContext('webgl')||a.getContext('experimental-webgl')).getSupportedExtensions();return!0}catch(b){}return!1};Nunu.runningOnDesktop=function(){return void 0!==window.nw};
Nunu.isFullscreen=function(){return document.webkitIsFullScreen||document.mozFullScreen||document.webkitIsFullScreen||document.webkitIsFullScreen||document.fullscreen||!1};
(function(a,b){'object'===typeof exports&&'undefined'!==typeof module?b(exports):'function'===typeof define&&define.amd?define(['exports'],b):b(a.THREE={})})(this,function(a){function b(){}function e(a,b){this.x=a||0;this.y=b||0}function c(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];0<arguments.length&&console.error('THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.')}function f(a,b,d,c){this._x=a||0;this._y=b||0;this._z=d||0;this._w=void 0!==c?c:1}function g(a,b,
d){this.x=a||0;this.y=b||0;this.z=d||0}function h(){this.elements=[1,0,0,0,1,0,0,0,1];0<arguments.length&&console.error('THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.')}function m(a,b,d,c,f,g,k,n,l,p){Object.defineProperty(this,'id',{value:Ta++});this.uuid=Aa.generateUUID();this.name='';this.image=void 0!==a?a:m.DEFAULT_IMAGE;this.mipmaps=[];this.mapping=void 0!==b?b:m.DEFAULT_MAPPING;this.wrapS=void 0!==d?d:1001;this.wrapT=void 0!==c?c:1001;this.magFilter=void 0!==
f?f:1006;this.minFilter=void 0!==g?g:1008;this.anisotropy=void 0!==l?l:1;this.format=void 0!==k?k:1023;this.type=void 0!==n?n:1009;this.offset=new e(0,0);this.repeat=new e(1,1);this.center=new e(0,0);this.rotation=0;this.matrixAutoUpdate=!0;this.matrix=new h;this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.encoding=void 0!==p?p:3E3;this.version=0;this.onUpdate=null}function l(a,b,d,c){this.x=a||0;this.y=b||0;this.z=d||0;this.w=void 0!==c?c:1}function p(a,
b,d){this.width=a;this.height=b;this.scissor=new l(0,0,a,b);this.scissorTest=!1;this.viewport=new l(0,0,a,b);d=d||{};void 0===d.minFilter&&(d.minFilter=1006);this.texture=new m(void 0,void 0,d.wrapS,d.wrapT,d.magFilter,d.minFilter,d.format,d.type,d.anisotropy,d.encoding);this.depthBuffer=void 0!==d.depthBuffer?d.depthBuffer:!0;this.stencilBuffer=void 0!==d.stencilBuffer?d.stencilBuffer:!0;this.depthTexture=void 0!==d.depthTexture?d.depthTexture:null}function k(a,b,d){p.call(this,a,b,d);this.activeMipMapLevel=
this.activeCubeFace=0}function d(a,b,d,c,f,e,g,h,k,n,l,p){m.call(this,null,e,g,h,k,n,c,f,l,p);this.image={data:a,width:b,height:d};this.magFilter=void 0!==k?k:1003;this.minFilter=void 0!==n?n:1003;this.flipY=this.generateMipmaps=!1;this.unpackAlignment=1}function n(a,b){this.min=void 0!==a?a:new g(Infinity,Infinity,Infinity);this.max=void 0!==b?b:new g(-Infinity,-Infinity,-Infinity)}function q(a,b){this.center=void 0!==a?a:new g;this.radius=void 0!==b?b:0}function r(a,b){this.normal=void 0!==a?a:
new g(1,0,0);this.constant=void 0!==b?b:0}function x(a,b,d,c,f,e){this.planes=[void 0!==a?a:new r,void 0!==b?b:new r,void 0!==d?d:new r,void 0!==c?c:new r,void 0!==f?f:new r,void 0!==e?e:new r]}function w(a,b,d){return void 0===b&&void 0===d?this.set(a):this.setRGB(a,b,d)}function t(a){function u(u,b){var d=u.array,c=u.dynamic?a.DYNAMIC_DRAW:a.STATIC_DRAW,f=a.createBuffer();a.bindBuffer(b,f);a.bufferData(b,d,c);u.onUploadCallback();b=a.FLOAT;d instanceof Float32Array?b=a.FLOAT:d instanceof Float64Array?
console.warn('THREE.WebGLAttributes: Unsupported data buffer format: Float64Array.'):d instanceof Uint16Array?b=a.UNSIGNED_SHORT:d instanceof Int16Array?b=a.SHORT:d instanceof Uint32Array?b=a.UNSIGNED_INT:d instanceof Int32Array?b=a.INT:d instanceof Int8Array?b=a.BYTE:d instanceof Uint8Array&&(b=a.UNSIGNED_BYTE);return{buffer:f,type:b,bytesPerElement:d.BYTES_PER_ELEMENT,version:u.version}}var b=new WeakMap;return{get:function(a){a.isInterleavedBufferAttribute&&(a=a.data);return b.get(a)},remove:function(u){u.isInterleavedBufferAttribute&&
(u=u.data);var d=b.get(u);d&&(a.deleteBuffer(d.buffer),b.delete(u))},update:function(d,c){d.isInterleavedBufferAttribute&&(d=d.data);var f=b.get(d);if(void 0===f)b.set(d,u(d,c));else if(f.version<d.version){var e=d,g=e.array,h=e.updateRange;a.bindBuffer(c,f.buffer);!1===e.dynamic?a.bufferData(c,g,a.STATIC_DRAW):-1===h.count?a.bufferSubData(c,0,g):0===h.count?console.error('THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.'):
(a.bufferSubData(c,h.offset*g.BYTES_PER_ELEMENT,g.subarray(h.offset,h.offset+h.count)),h.count=-1);f.version=d.version}}}}function v(a,b,d,c){this._x=a||0;this._y=b||0;this._z=d||0;this._order=c||v.DefaultOrder}function A(){this.mask=1}function z(){Object.defineProperty(this,'id',{value:og++});this.uuid=Aa.generateUUID();this.name='';this.type='Object3D';this.parent=null;this.children=[];this.up=z.DefaultUp.clone();var a=new g,b=new v,d=new f,e=new g(1,1,1);b.onChange(function(){d.setFromEuler(b,
!1)});d.onChange(function(){b.setFromQuaternion(d,void 0,!1)});Object.defineProperties(this,{position:{enumerable:!0,value:a},rotation:{enumerable:!0,value:b},quaternion:{enumerable:!0,value:d},scale:{enumerable:!0,value:e},modelViewMatrix:{value:new c},normalMatrix:{value:new h}});this.matrix=new c;this.matrixWorld=new c;this.matrixAutoUpdate=z.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate=!1;this.layers=new A;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=
0;this.userData={}}function B(){z.call(this);this.type='Camera';this.matrixWorldInverse=new c;this.projectionMatrix=new c}function D(a,b,d,c,f,e){B.call(this);this.type='OrthographicCamera';this.zoom=1;this.view=null;this.left=a;this.right=b;this.top=d;this.bottom=c;this.near=void 0!==f?f:.1;this.far=void 0!==e?e:2E3;this.updateProjectionMatrix()}function C(a,b,d,c,f,e){this.a=a;this.b=b;this.c=d;this.normal=c&&c.isVector3?c:new g;this.vertexNormals=Array.isArray(c)?c:[];this.color=f&&f.isColor?f:
new w;this.vertexColors=Array.isArray(f)?f:[];this.materialIndex=void 0!==e?e:0}function y(){Object.defineProperty(this,'id',{value:wg+=2});this.uuid=Aa.generateUUID();this.name='';this.type='Geometry';this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=
this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function G(a,b,d){if(Array.isArray(a))throw new TypeError('THREE.BufferAttribute: array should be a Typed Array.');this.name='';this.array=a;this.itemSize=b;this.count=void 0!==a?a.length/b:0;this.normalized=!0===d;this.dynamic=!1;this.updateRange={offset:0,count:-1};this.version=0}function J(a,b,d){G.call(this,new Int8Array(a),b,d)}function I(a,b,d){G.call(this,new Uint8Array(a),b,d)}function K(a,b,d){G.call(this,new Uint8ClampedArray(a),
b,d)}function M(a,b,d){G.call(this,new Int16Array(a),b,d)}function L(a,b,d){G.call(this,new Uint16Array(a),b,d)}function F(a,b,d){G.call(this,new Int32Array(a),b,d)}function U(a,b,d){G.call(this,new Uint32Array(a),b,d)}function N(a,b,d){G.call(this,new Float32Array(a),b,d)}function Y(a,b,d){G.call(this,new Float64Array(a),b,d)}function W(){this.vertices=[];this.normals=[];this.colors=[];this.uvs=[];this.uvs2=[];this.groups=[];this.morphTargets={};this.skinWeights=[];this.skinIndices=[];this.boundingSphere=
this.boundingBox=null;this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function E(a){if(0===a.length)return-Infinity;for(var u=a[0],b=1,d=a.length;b<d;++b)a[b]>u&&(u=a[b]);return u}function V(){Object.defineProperty(this,'id',{value:xg+=2});this.uuid=Aa.generateUUID();this.name='';this.type='BufferGeometry';this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.drawRange=
{start:0,count:Infinity}}function aa(a,b,d,c,f,e){y.call(this);this.type='BoxGeometry';this.parameters={width:a,height:b,depth:d,widthSegments:c,heightSegments:f,depthSegments:e};this.fromBufferGeometry(new Q(a,b,d,c,f,e));this.mergeVertices()}function Q(a,b,d,c,f,e){function u(a,u,b,d,c,f,e,t,q,v,ka){var r=f/q,x=e/v,w=f/2,jb=e/2,A=t/2;e=q+1;var H=v+1,z=f=0,D,y,ta=new g;for(y=0;y<H;y++){var B=y*x-jb;for(D=0;D<e;D++)ta[a]=(D*r-w)*d,ta[u]=B*c,ta[b]=A,n.push(ta.x,ta.y,ta.z),ta[a]=0,ta[u]=0,ta[b]=0<t?
1:-1,ba.push(ta.x,ta.y,ta.z),l.push(D/q),l.push(1-y/v),f+=1}for(y=0;y<v;y++)for(D=0;D<q;D++)a=p+D+e*(y+1),u=p+(D+1)+e*(y+1),b=p+(D+1)+e*y,k.push(p+D+e*y,a,b),k.push(a,u,b),z+=6;h.addGroup(m,z,ka);m+=z;p+=f}V.call(this);this.type='BoxBufferGeometry';this.parameters={width:a,height:b,depth:d,widthSegments:c,heightSegments:f,depthSegments:e};var h=this;a=a||1;b=b||1;d=d||1;c=Math.floor(c)||1;f=Math.floor(f)||1;e=Math.floor(e)||1;var k=[],n=[],ba=[],l=[],p=0,m=0;u('z','y','x',-1,-1,d,b,a,e,f,0);u('z',
'y','x',1,-1,d,b,-a,e,f,1);u('x','z','y',1,1,a,d,b,c,e,2);u('x','z','y',1,-1,a,d,-b,c,e,3);u('x','y','z',1,-1,a,b,d,c,f,4);u('x','y','z',-1,-1,a,b,-d,c,f,5);this.setIndex(k);this.addAttribute('position',new N(n,3));this.addAttribute('normal',new N(ba,3));this.addAttribute('uv',new N(l,2))}function S(a,b,d,c){y.call(this);this.type='PlaneGeometry';this.parameters={width:a,height:b,widthSegments:d,heightSegments:c};this.fromBufferGeometry(new X(a,b,d,c));this.mergeVertices()}function X(a,b,d,c){V.call(this);
this.type='PlaneBufferGeometry';this.parameters={width:a,height:b,widthSegments:d,heightSegments:c};a=a||1;b=b||1;var u=a/2,f=b/2;d=Math.floor(d)||1;c=Math.floor(c)||1;var e=d+1,g=c+1,h=a/d,k=b/c,n=[],ba=[],l=[],p=[];for(a=0;a<g;a++){var m=a*k-f;for(b=0;b<e;b++)ba.push(b*h-u,-m,0),l.push(0,0,1),p.push(b/d),p.push(1-a/c)}for(a=0;a<c;a++)for(b=0;b<d;b++)u=b+e*(a+1),f=b+1+e*(a+1),g=b+1+e*a,n.push(b+e*a,u,g),n.push(u,f,g);this.setIndex(n);this.addAttribute('position',new N(ba,3));this.addAttribute('normal',
new N(l,3));this.addAttribute('uv',new N(p,2))}function T(){Object.defineProperty(this,'id',{value:Ea++});this.uuid=Aa.generateUUID();this.name='';this.type='Material';this.lights=this.fog=!0;this.blending=1;this.side=0;this.flatShading=!1;this.vertexColors=0;this.opacity=1;this.transparent=!1;this.blendSrc=204;this.blendDst=205;this.blendEquation=100;this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null;this.depthFunc=3;this.depthWrite=this.depthTest=!0;this.clippingPlanes=null;this.clipShadows=
this.clipIntersection=!1;this.shadowSide=null;this.colorWrite=!0;this.precision=null;this.polygonOffset=!1;this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.dithering=!1;this.alphaTest=0;this.premultipliedAlpha=!1;this.overdraw=0;this.visible=!0;this.userData={};this.needsUpdate=!0}function R(a){T.call(this);this.type='MeshBasicMaterial';this.color=new w(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.envMap=this.alphaMap=this.specularMap=
null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap='round';this.lights=this.morphTargets=this.skinning=!1;this.setValues(a)}function O(a){T.call(this);this.type='ShaderMaterial';this.defines={};this.uniforms={};this.vertexShader='void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}';this.fragmentShader='void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}';
this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1;this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1};this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName=void 0;this.uniformsNeedUpdate=!1;void 0!==a&&(void 0!==a.attributes&&console.error('THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.'),this.setValues(a))}
function ea(a,b){this.origin=void 0!==a?a:new g;this.direction=void 0!==b?b:new g}function ca(a,b){this.start=void 0!==a?a:new g;this.end=void 0!==b?b:new g}function P(a,b,d){this.a=void 0!==a?a:new g;this.b=void 0!==b?b:new g;this.c=void 0!==d?d:new g}function Z(a,b){z.call(this);this.type='Mesh';this.geometry=void 0!==a?a:new V;this.material=void 0!==b?b:new R({color:16777215*Math.random()});this.drawMode=0;this.updateMorphTargets()}function H(a,b,d,c){function u(a,u){b.buffers.color.setClear(a.r,
a.g,a.b,u,c)}var f=new w(0),e=0,g,h,k;return{getClearColor:function(){return f},setClearColor:function(a,b){f.set(a);e=void 0!==b?b:1;u(f,e)},getClearAlpha:function(){return e},setClearAlpha:function(a){e=a;u(f,e)},render:function(b,c,n,l){c=c.background;null===c?u(f,e):c&&c.isColor&&(u(c,1),l=!0);(a.autoClear||l)&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil);c&&c.isCubeTexture?(void 0===k&&(k=new Z(new Q(1,1,1),new O({uniforms:Rb.cube.uniforms,vertexShader:Rb.cube.vertexShader,fragmentShader:Rb.cube.fragmentShader,
side:1,depthTest:!0,depthWrite:!1,fog:!1})),k.geometry.removeAttribute('normal'),k.geometry.removeAttribute('uv'),k.onBeforeRender=function(a,u,b){this.matrixWorld.copyPosition(b.matrixWorld)},d.update(k.geometry)),k.material.uniforms.tCube.value=c,b.push(k,k.geometry,k.material,0,null)):c&&c.isTexture&&(void 0===g&&(g=new D(-1,1,1,-1,0,1),h=new Z(new X(2,2),new R({depthTest:!1,depthWrite:!1,fog:!1})),d.update(h.geometry)),h.material.map=c,a.renderBufferDirect(g,null,h.geometry,h.material,h,null))}}}
function fa(a,b,d){var u;this.setMode=function(a){u=a};this.render=function(b,c){a.drawArrays(u,b,c);d.update(c,u)};this.renderInstances=function(a,c,f){var e=b.get('ANGLE_instanced_arrays');if(null===e)console.error('THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.');else{var g=a.attributes.position;g.isInterleavedBufferAttribute?(f=g.data.count,e.drawArraysInstancedANGLE(u,0,f,a.maxInstancedCount)):e.drawArraysInstancedANGLE(u,
c,f,a.maxInstancedCount);d.update(f,u,a.maxInstancedCount)}}}function ia(a,b,d){function u(u){if('highp'===u){if(0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.HIGH_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision)return'highp';u='mediump'}return'mediump'===u&&0<a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.MEDIUM_FLOAT).precision&&0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.MEDIUM_FLOAT).precision?'mediump':'lowp'}var c,f=void 0!==d.precision?d.precision:
'highp',e=u(f);e!==f&&(console.warn('THREE.WebGLRenderer:',f,'not supported, using',e,'instead.'),f=e);d=!0===d.logarithmicDepthBuffer;e=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS);var g=a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=a.getParameter(a.MAX_TEXTURE_SIZE),k=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE),n=a.getParameter(a.MAX_VERTEX_ATTRIBS),l=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS),ba=a.getParameter(a.MAX_VARYING_VECTORS),p=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS),m=0<g,t=
!!b.get('OES_texture_float');return{getMaxAnisotropy:function(){if(void 0!==c)return c;var u=b.get('EXT_texture_filter_anisotropic');return c=null!==u?a.getParameter(u.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:u,precision:f,logarithmicDepthBuffer:d,maxTextures:e,maxVertexTextures:g,maxTextureSize:h,maxCubemapSize:k,maxAttributes:n,maxVertexUniforms:l,maxVaryings:ba,maxFragmentUniforms:p,vertexTextures:m,floatFragmentTextures:t,floatVertexTextures:m&&t}}function ha(){function a(){l.value!==
c&&(l.value=c,l.needsUpdate=0<f);d.numPlanes=f;d.numIntersection=0}function b(a,u,b,c){var f=null!==a?a.length:0,e=null;if(0!==f){e=l.value;if(!0!==c||null===e){c=b+4*f;u=u.matrixWorldInverse;n.getNormalMatrix(u);if(null===e||e.length<c)e=new Float32Array(c);for(c=0;c!==f;++c,b+=4)k.copy(a[c]).applyMatrix4(u,n),k.normal.toArray(e,b),e[b+3]=k.constant}l.value=e;l.needsUpdate=!0}d.numPlanes=f;return e}var d=this,c=null,f=0,e=!1,g=!1,k=new r,n=new h,l={value:null,needsUpdate:!1};this.uniform=l;this.numIntersection=
this.numPlanes=0;this.init=function(a,u,d){var g=0!==a.length||u||0!==f||e;e=u;c=b(a,d,0);f=a.length;return g};this.beginShadows=function(){g=!0;b(null)};this.endShadows=function(){g=!1;a()};this.setState=function(u,d,h,k,n,ba){if(!e||null===u||0===u.length||g&&!h)g?b(null):a();else{h=g?0:f;var p=4*h,m=n.clippingState||null;l.value=m;m=b(u,k,p,ba);for(u=0;u!==p;++u)m[u]=c[u];n.clippingState=m;this.numIntersection=d?this.numPlanes:0;this.numPlanes+=h}}}function Ba(a){var u={};return{get:function(b){if(void 0!==
u[b])return u[b];switch(b){case 'WEBGL_depth_texture':var d=a.getExtension('WEBGL_depth_texture')||a.getExtension('MOZ_WEBGL_depth_texture')||a.getExtension('WEBKIT_WEBGL_depth_texture');break;case 'EXT_texture_filter_anisotropic':d=a.getExtension('EXT_texture_filter_anisotropic')||a.getExtension('MOZ_EXT_texture_filter_anisotropic')||a.getExtension('WEBKIT_EXT_texture_filter_anisotropic');break;case 'WEBGL_compressed_texture_s3tc':d=a.getExtension('WEBGL_compressed_texture_s3tc')||a.getExtension('MOZ_WEBGL_compressed_texture_s3tc')||
a.getExtension('WEBKIT_WEBGL_compressed_texture_s3tc');break;case 'WEBGL_compressed_texture_pvrtc':d=a.getExtension('WEBGL_compressed_texture_pvrtc')||a.getExtension('WEBKIT_WEBGL_compressed_texture_pvrtc');break;case 'WEBGL_compressed_texture_etc1':d=a.getExtension('WEBGL_compressed_texture_etc1');break;default:d=a.getExtension(b)}null===d&&console.warn('THREE.WebGLRenderer: '+b+' extension not supported.');return u[b]=d}}}function za(a,b,d){function u(a){a=a.target;var e=c[a.id];null!==e.index&&
b.remove(e.index);for(var g in e.attributes)b.remove(e.attributes[g]);a.removeEventListener('dispose',u);delete c[a.id];if(g=f[a.id])b.remove(g),delete f[a.id];if(g=f[e.id])b.remove(g),delete f[e.id];d.memory.geometries--}var c={},f={};return{get:function(a,b){var f=c[b.id];if(f)return f;b.addEventListener('dispose',u);b.isBufferGeometry?f=b:b.isGeometry&&(void 0===b._bufferGeometry&&(b._bufferGeometry=(new V).setFromObject(a)),f=b._bufferGeometry);c[b.id]=f;d.memory.geometries++;return f},update:function(u){var d=
u.index,c=u.attributes;null!==d&&b.update(d,a.ELEMENT_ARRAY_BUFFER);for(var f in c)b.update(c[f],a.ARRAY_BUFFER);u=u.morphAttributes;for(f in u){d=u[f];c=0;for(var e=d.length;c<e;c++)b.update(d[c],a.ARRAY_BUFFER)}},getWireframeAttribute:function(u){var d=f[u.id];if(d)return d;d=[];var c=u.index,e=u.attributes;if(null!==c){c=c.array;e=0;for(var g=c.length;e<g;e+=3){var h=c[e+0],k=c[e+1],n=c[e+2];d.push(h,k,k,n,n,h)}}else for(c=e.position.array,e=0,g=c.length/3-1;e<g;e+=3)h=e+0,k=e+1,n=e+2,d.push(h,
k,k,n,n,h);d=new (65535<E(d)?U:L)(d,1);b.update(d,a.ELEMENT_ARRAY_BUFFER);return f[u.id]=d}}}function La(a,b,d){var u,c,f;this.setMode=function(a){u=a};this.setIndex=function(a){c=a.type;f=a.bytesPerElement};this.render=function(b,e){a.drawElements(u,e,c,b*f);d.update(e,u)};this.renderInstances=function(a,e,g){var h=b.get('ANGLE_instanced_arrays');null===h?console.error('THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.'):
(h.drawElementsInstancedANGLE(u,g,c,e*f,a.maxInstancedCount),d.update(g,u,a.maxInstancedCount))}}function ra(a){var u={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:u,programs:null,autoReset:!0,reset:function(){u.frame++;u.calls=0;u.triangles=0;u.points=0;u.lines=0},update:function(b,d,c){c=c||1;u.calls++;switch(d){case a.TRIANGLES:u.triangles+=b/3*c;break;case a.TRIANGLE_STRIP:case a.TRIANGLE_FAN:u.triangles+=c*(b-2);break;case a.LINES:u.lines+=b/2*
c;break;case a.LINE_STRIP:u.lines+=c*(b-1);break;case a.LINE_LOOP:u.lines+=c*b;break;case a.POINTS:u.points+=c*b;break;default:console.error('THREE.WebGLInfo: Unknown draw mode:',d)}}}}function Ja(a,b){return Math.abs(b[1])-Math.abs(a[1])}function Ma(a){var u={},b=new Float32Array(8);return{update:function(d,c,f,e){var g=d.morphTargetInfluences,h=g.length;d=u[c.id];if(void 0===d){d=[];for(var k=0;k<h;k++)d[k]=[k,0];u[c.id]=d}var n=f.morphTargets&&c.morphAttributes.position;f=f.morphNormals&&c.morphAttributes.normal;
for(k=0;k<h;k++){var l=d[k];0!==l[1]&&(n&&c.removeAttribute('morphTarget'+k),f&&c.removeAttribute('morphNormal'+k))}for(k=0;k<h;k++)l=d[k],l[0]=k,l[1]=g[k];d.sort(Ja);for(k=0;8>k;k++){if(l=d[k])if(g=l[0],h=l[1]){n&&c.addAttribute('morphTarget'+k,n[g]);f&&c.addAttribute('morphNormal'+k,f[g]);b[k]=h;continue}b[k]=0}e.getUniforms().setValue(a,'morphTargetInfluences',b)}}}function pb(a,b){var u={};return{update:function(d){var c=b.render.frame,f=d.geometry,e=a.get(d,f);u[e.id]!==c&&(f.isGeometry&&e.updateFromObject(d),
a.update(e),u[e.id]=c);return e},dispose:function(){u={}}}}function ya(a,b,d,c,f,e,g,h,k,n){a=void 0!==a?a:[];m.call(this,a,void 0!==b?b:301,d,c,f,e,g,h,k,n);this.flipY=!1}function ua(a,b,d){var u=a[0];if(0>=u||0<u)return a;var c=b*d,f=rc[c];void 0===f&&(f=new Float32Array(c),rc[c]=f);if(0!==b)for(u.toArray(f,0),u=1,c=0;u!==b;++u)c+=d,a[u].toArray(f,c);return f}function Fa(a,b){var u=Tf[b];void 0===u&&(u=new Int32Array(b),Tf[b]=u);for(var d=0;d!==b;++d)u[d]=a.allocTextureUnit();return u}function eb(a,
b){a.uniform1f(this.addr,b)}function hb(a,b){a.uniform1i(this.addr,b)}function Sa(a,b){void 0===b.x?a.uniform2fv(this.addr,b):a.uniform2f(this.addr,b.x,b.y)}function oa(a,b){void 0!==b.x?a.uniform3f(this.addr,b.x,b.y,b.z):void 0!==b.r?a.uniform3f(this.addr,b.r,b.g,b.b):a.uniform3fv(this.addr,b)}function Ia(a,b){void 0===b.x?a.uniform4fv(this.addr,b):a.uniform4f(this.addr,b.x,b.y,b.z,b.w)}function Ca(a,b){a.uniformMatrix2fv(this.addr,!1,b.elements||b)}function wa(a,b){void 0===b.elements?a.uniformMatrix3fv(this.addr,
!1,b):(qe.set(b.elements),a.uniformMatrix3fv(this.addr,!1,qe))}function Ga(a,b){void 0===b.elements?a.uniformMatrix4fv(this.addr,!1,b):(pg.set(b.elements),a.uniformMatrix4fv(this.addr,!1,pg))}function da(a,b,d){var u=d.allocTextureUnit();a.uniform1i(this.addr,u);d.setTexture2D(b||Ef,u)}function Ua(a,b,d){var u=d.allocTextureUnit();a.uniform1i(this.addr,u);d.setTextureCube(b||od,u)}function Eb(a,b){a.uniform2iv(this.addr,b)}function bb(a,b){a.uniform3iv(this.addr,b)}function Na(a,b){a.uniform4iv(this.addr,
b)}function Fb(a){switch(a){case 5126:return eb;case 35664:return Sa;case 35665:return oa;case 35666:return Ia;case 35674:return Ca;case 35675:return wa;case 35676:return Ga;case 35678:case 36198:return da;case 35680:return Ua;case 5124:case 35670:return hb;case 35667:case 35671:return Eb;case 35668:case 35672:return bb;case 35669:case 35673:return Na}}function Xa(a,b){a.uniform1fv(this.addr,b)}function Lb(a,b){a.uniform1iv(this.addr,b)}function Da(a,b){a.uniform2fv(this.addr,ua(b,this.size,2))}function Yb(a,
b){a.uniform3fv(this.addr,ua(b,this.size,3))}function Sb(a,b){a.uniform4fv(this.addr,ua(b,this.size,4))}function gc(a,b){a.uniformMatrix2fv(this.addr,!1,ua(b,this.size,4))}function Od(a,b){a.uniformMatrix3fv(this.addr,!1,ua(b,this.size,9))}function Mb(a,b){a.uniformMatrix4fv(this.addr,!1,ua(b,this.size,16))}function Nb(a,b,d){var u=b.length,c=Fa(d,u);a.uniform1iv(this.addr,c);for(a=0;a!==u;++a)d.setTexture2D(b[a]||Ef,c[a])}function qb(a,b,d){var u=b.length,c=Fa(d,u);a.uniform1iv(this.addr,c);for(a=
0;a!==u;++a)d.setTextureCube(b[a]||od,c[a])}function ma(a){switch(a){case 5126:return Xa;case 35664:return Da;case 35665:return Yb;case 35666:return Sb;case 35674:return gc;case 35675:return Od;case 35676:return Mb;case 35678:return Nb;case 35680:return qb;case 5124:case 35670:return Lb;case 35667:case 35671:return Eb;case 35668:case 35672:return bb;case 35669:case 35673:return Na}}function Tb(a,b,d){this.id=a;this.addr=d;this.setValue=Fb(b.type)}function ja(a,b,d){this.id=a;this.addr=d;this.size=
b.size;this.setValue=ma(b.type)}function la(a){this.id=a;this.seq=[];this.map={}}function bc(a,b,d){this.seq=[];this.map={};this.renderer=d;d=a.getProgramParameter(b,a.ACTIVE_UNIFORMS);for(var u=0;u<d;++u){var c=a.getActiveUniform(b,u),f=a.getUniformLocation(b,c.name),e=this,g=c.name,h=g.length;for(Uf.lastIndex=0;;){var k=Uf.exec(g),n=Uf.lastIndex,l=k[1],p=k[3];']'===k[2]&&(l|=0);if(void 0===p||'['===p&&n+2===h){g=e;c=void 0===p?new Tb(l,c,f):new ja(l,c,f);g.seq.push(c);g.map[c.id]=c;break}else p=
e.map[l],void 0===p&&(p=new la(l),l=e,e=p,l.seq.push(e),l.map[e.id]=e),e=p}}}function rb(a){a=a.split('\n');for(var u=0;u<a.length;u++)a[u]=u+1+': '+a[u];return a.join('\n')}function sb(a,b,d){var u=a.createShader(b);a.shaderSource(u,d);a.compileShader(u);!1===a.getShaderParameter(u,a.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile.");''!==a.getShaderInfoLog(u)&&console.warn('THREE.WebGLShader: gl.getShaderInfoLog()',b===a.VERTEX_SHADER?'vertex':'fragment',a.getShaderInfoLog(u),
rb(d));return u}function kb(a){switch(a){case 3E3:return['Linear','( value )'];case 3001:return['sRGB','( value )'];case 3002:return['RGBE','( value )'];case 3004:return['RGBM','( value, 7.0 )'];case 3005:return['RGBM','( value, 16.0 )'];case 3006:return['RGBD','( value, 256.0 )'];case 3007:return['Gamma','( value, float( GAMMA_FACTOR ) )'];default:throw Error('unsupported encoding: '+a);}}function Ab(a,b){b=kb(b);return'vec4 '+a+'( vec4 value ) { return '+b[0]+'ToLinear'+b[1]+'; }'}function re(a,
b){b=kb(b);return'vec4 '+a+'( vec4 value ) { return LinearTo'+b[0]+b[1]+'; }'}function Zb(a,b){switch(b){case 1:b='Linear';break;case 2:b='Reinhard';break;case 3:b='Uncharted2';break;case 4:b='OptimizedCineon';break;default:throw Error('unsupported toneMapping: '+b);}return'vec3 '+a+'( vec3 color ) { return '+b+'ToneMapping( color ); }'}function Xc(a,b,d){a=a||{};return[a.derivatives||b.envMapCubeUV||b.bumpMap||b.normalMap||b.flatShading?'#extension GL_OES_standard_derivatives : enable':'',(a.fragDepth||
b.logarithmicDepthBuffer)&&d.get('EXT_frag_depth')?'#extension GL_EXT_frag_depth : enable':'',a.drawBuffers&&d.get('WEBGL_draw_buffers')?'#extension GL_EXT_draw_buffers : require':'',(a.shaderTextureLOD||b.envMap)&&d.get('EXT_shader_texture_lod')?'#extension GL_EXT_shader_texture_lod : enable':''].filter(Oa).join('\n')}function zc(a){var u=[],b;for(b in a){var d=a[b];!1!==d&&u.push('#define '+b+' '+d)}return u.join('\n')}function Oa(a){return''!==a}function Ac(a,b){return a.replace(/NUM_DIR_LIGHTS/g,
b.numDirLights).replace(/NUM_SPOT_LIGHTS/g,b.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,b.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,b.numPointLights).replace(/NUM_HEMI_LIGHTS/g,b.numHemiLights)}function hc(a,b){return a.replace(/NUM_CLIPPING_PLANES/g,b.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,b.numClippingPlanes-b.numClipIntersection)}function lb(a){return a.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(a,u){a=sa[u];if(void 0===a)throw Error('Can not resolve #include <'+u+
'>');return lb(a)})}function Pa(a){return a.replace(/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(a,u,b,d){a='';for(u=parseInt(u);u<parseInt(b);u++)a+=d.replace(/\[ i \]/g,'[ '+u+' ]');return a})}function xa(a,b,d,c,f,e){var u=a.context,g=c.defines,h=f.vertexShader,k=f.fragmentShader,n='SHADOWMAP_TYPE_BASIC';1===e.shadowMapType?n='SHADOWMAP_TYPE_PCF':2===e.shadowMapType&&(n='SHADOWMAP_TYPE_PCF_SOFT');var l='ENVMAP_TYPE_CUBE',p='ENVMAP_MODE_REFLECTION',
m='ENVMAP_BLENDING_MULTIPLY';if(e.envMap){switch(c.envMap.mapping){case 301:case 302:l='ENVMAP_TYPE_CUBE';break;case 306:case 307:l='ENVMAP_TYPE_CUBE_UV';break;case 303:case 304:l='ENVMAP_TYPE_EQUIREC';break;case 305:l='ENVMAP_TYPE_SPHERE'}switch(c.envMap.mapping){case 302:case 304:p='ENVMAP_MODE_REFRACTION'}switch(c.combine){case 0:m='ENVMAP_BLENDING_MULTIPLY';break;case 1:m='ENVMAP_BLENDING_MIX';break;case 2:m='ENVMAP_BLENDING_ADD'}}var ba=0<a.gammaFactor?a.gammaFactor:1,t=Xc(c.extensions,e,b),
q=zc(g),v=u.createProgram();c.isRawShaderMaterial?(g=[q].filter(Oa).join('\n'),0<g.length&&(g+='\n'),b=[t,q].filter(Oa).join('\n'),0<b.length&&(b+='\n')):(g=['precision '+e.precision+' float;','precision '+e.precision+' int;','#define SHADER_NAME '+f.name,q,e.supportsVertexTextures?'#define VERTEX_TEXTURES':'','#define GAMMA_FACTOR '+ba,'#define MAX_BONES '+e.maxBones,e.useFog&&e.fog?'#define USE_FOG':'',e.useFog&&e.fogExp?'#define FOG_EXP2':'',e.map?'#define USE_MAP':'',e.envMap?'#define USE_ENVMAP':
'',e.envMap?'#define '+p:'',e.lightMap?'#define USE_LIGHTMAP':'',e.aoMap?'#define USE_AOMAP':'',e.emissiveMap?'#define USE_EMISSIVEMAP':'',e.bumpMap?'#define USE_BUMPMAP':'',e.normalMap?'#define USE_NORMALMAP':'',e.displacementMap&&e.supportsVertexTextures?'#define USE_DISPLACEMENTMAP':'',e.specularMap?'#define USE_SPECULARMAP':'',e.roughnessMap?'#define USE_ROUGHNESSMAP':'',e.metalnessMap?'#define USE_METALNESSMAP':'',e.alphaMap?'#define USE_ALPHAMAP':'',e.vertexColors?'#define USE_COLOR':'',e.flatShading?
'#define FLAT_SHADED':'',e.skinning?'#define USE_SKINNING':'',e.useVertexTexture?'#define BONE_TEXTURE':'',e.morphTargets?'#define USE_MORPHTARGETS':'',e.morphNormals&&!1===e.flatShading?'#define USE_MORPHNORMALS':'',e.doubleSided?'#define DOUBLE_SIDED':'',e.flipSided?'#define FLIP_SIDED':'',e.shadowMapEnabled?'#define USE_SHADOWMAP':'',e.shadowMapEnabled?'#define '+n:'',e.sizeAttenuation?'#define USE_SIZEATTENUATION':'',e.logarithmicDepthBuffer?'#define USE_LOGDEPTHBUF':'',e.logarithmicDepthBuffer&&
b.get('EXT_frag_depth')?'#define USE_LOGDEPTHBUF_EXT':'','uniform mat4 modelMatrix;','uniform mat4 modelViewMatrix;','uniform mat4 projectionMatrix;','uniform mat4 viewMatrix;','uniform mat3 normalMatrix;','uniform vec3 cameraPosition;','attribute vec3 position;','attribute vec3 normal;','attribute vec2 uv;','#ifdef USE_COLOR','\tattribute vec3 color;','#endif','#ifdef USE_MORPHTARGETS','\tattribute vec3 morphTarget0;','\tattribute vec3 morphTarget1;','\tattribute vec3 morphTarget2;','\tattribute vec3 morphTarget3;',
'\t#ifdef USE_MORPHNORMALS','\t\tattribute vec3 morphNormal0;','\t\tattribute vec3 morphNormal1;','\t\tattribute vec3 morphNormal2;','\t\tattribute vec3 morphNormal3;','\t#else','\t\tattribute vec3 morphTarget4;','\t\tattribute vec3 morphTarget5;','\t\tattribute vec3 morphTarget6;','\t\tattribute vec3 morphTarget7;','\t#endif','#endif','#ifdef USE_SKINNING','\tattribute vec4 skinIndex;','\tattribute vec4 skinWeight;','#endif','\n'].filter(Oa).join('\n'),b=[t,'precision '+e.precision+' float;','precision '+
e.precision+' int;','#define SHADER_NAME '+f.name,q,e.alphaTest?'#define ALPHATEST '+e.alphaTest:'','#define GAMMA_FACTOR '+ba,e.useFog&&e.fog?'#define USE_FOG':'',e.useFog&&e.fogExp?'#define FOG_EXP2':'',e.map?'#define USE_MAP':'',e.envMap?'#define USE_ENVMAP':'',e.envMap?'#define '+l:'',e.envMap?'#define '+p:'',e.envMap?'#define '+m:'',e.lightMap?'#define USE_LIGHTMAP':'',e.aoMap?'#define USE_AOMAP':'',e.emissiveMap?'#define USE_EMISSIVEMAP':'',e.bumpMap?'#define USE_BUMPMAP':'',e.normalMap?'#define USE_NORMALMAP':
'',e.specularMap?'#define USE_SPECULARMAP':'',e.roughnessMap?'#define USE_ROUGHNESSMAP':'',e.metalnessMap?'#define USE_METALNESSMAP':'',e.alphaMap?'#define USE_ALPHAMAP':'',e.vertexColors?'#define USE_COLOR':'',e.gradientMap?'#define USE_GRADIENTMAP':'',e.flatShading?'#define FLAT_SHADED':'',e.doubleSided?'#define DOUBLE_SIDED':'',e.flipSided?'#define FLIP_SIDED':'',e.shadowMapEnabled?'#define USE_SHADOWMAP':'',e.shadowMapEnabled?'#define '+n:'',e.premultipliedAlpha?'#define PREMULTIPLIED_ALPHA':
'',e.physicallyCorrectLights?'#define PHYSICALLY_CORRECT_LIGHTS':'',e.logarithmicDepthBuffer?'#define USE_LOGDEPTHBUF':'',e.logarithmicDepthBuffer&&b.get('EXT_frag_depth')?'#define USE_LOGDEPTHBUF_EXT':'',e.envMap&&b.get('EXT_shader_texture_lod')?'#define TEXTURE_LOD_EXT':'','uniform mat4 viewMatrix;','uniform vec3 cameraPosition;',0!==e.toneMapping?'#define TONE_MAPPING':'',0!==e.toneMapping?sa.tonemapping_pars_fragment:'',0!==e.toneMapping?Zb('toneMapping',e.toneMapping):'',e.dithering?'#define DITHERING':
'',e.outputEncoding||e.mapEncoding||e.envMapEncoding||e.emissiveMapEncoding?sa.encodings_pars_fragment:'',e.mapEncoding?Ab('mapTexelToLinear',e.mapEncoding):'',e.envMapEncoding?Ab('envMapTexelToLinear',e.envMapEncoding):'',e.emissiveMapEncoding?Ab('emissiveMapTexelToLinear',e.emissiveMapEncoding):'',e.outputEncoding?re('linearToOutputTexel',e.outputEncoding):'',e.depthPacking?'#define DEPTH_PACKING '+c.depthPacking:'','\n'].filter(Oa).join('\n'));h=lb(h);h=Ac(h,e);h=hc(h,e);k=lb(k);k=Ac(k,e);k=hc(k,
e);h=Pa(h);k=Pa(k);k=b+k;h=sb(u,u.VERTEX_SHADER,g+h);k=sb(u,u.FRAGMENT_SHADER,k);u.attachShader(v,h);u.attachShader(v,k);void 0!==c.index0AttributeName?u.bindAttribLocation(v,0,c.index0AttributeName):!0===e.morphTargets&&u.bindAttribLocation(v,0,'position');u.linkProgram(v);e=u.getProgramInfoLog(v).trim();f=u.getShaderInfoLog(h).trim();n=u.getShaderInfoLog(k).trim();p=l=!0;if(!1===u.getProgramParameter(v,u.LINK_STATUS))l=!1,console.error('THREE.WebGLProgram: shader error: ',u.getError(),'gl.VALIDATE_STATUS',
u.getProgramParameter(v,u.VALIDATE_STATUS),'gl.getProgramInfoLog',e,f,n);else if(''!==e)console.warn('THREE.WebGLProgram: gl.getProgramInfoLog()',e);else if(''===f||''===n)p=!1;p&&(this.diagnostics={runnable:l,material:c,programLog:e,vertexShader:{log:f,prefix:g},fragmentShader:{log:n,prefix:b}});u.deleteShader(h);u.deleteShader(k);var r;this.getUniforms=function(){void 0===r&&(r=new bc(u,v,a));return r};var ka;this.getAttributes=function(){if(void 0===ka){for(var a={},b=u.getProgramParameter(v,u.ACTIVE_ATTRIBUTES),
d=0;d<b;d++){var c=u.getActiveAttrib(v,d).name;a[c]=u.getAttribLocation(v,c)}ka=a}return ka};this.destroy=function(){u.deleteProgram(v);this.program=void 0};Object.defineProperties(this,{uniforms:{get:function(){console.warn('THREE.WebGLProgram: .uniforms is now .getUniforms().');return this.getUniforms()}},attributes:{get:function(){console.warn('THREE.WebGLProgram: .attributes is now .getAttributes().');return this.getAttributes()}}});this.id=hg++;this.code=d;this.usedTimes=1;this.program=v;this.vertexShader=
h;this.fragmentShader=k;return this}function ef(a,b,d){function u(a,u){if(a)a.isTexture?b=a.encoding:a.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),b=a.texture.encoding);else var b=3E3;3E3===b&&u&&(b=3007);return b}var c=[],f={MeshDepthMaterial:'depth',MeshDistanceMaterial:'distanceRGBA',MeshNormalMaterial:'normal',MeshBasicMaterial:'basic',MeshLambertMaterial:'lambert',MeshPhongMaterial:'phong',
MeshToonMaterial:'phong',MeshStandardMaterial:'physical',MeshPhysicalMaterial:'physical',LineBasicMaterial:'basic',LineDashedMaterial:'dashed',PointsMaterial:'points',ShadowMaterial:'shadow'},e='precision supportsVertexTextures map mapEncoding envMap envMapMode envMapEncoding lightMap aoMap emissiveMap emissiveMapEncoding bumpMap normalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering'.split(' ');
this.getParameters=function(b,c,e,g,h,k,n){var l=f[b.type];if(n.isSkinnedMesh){var p=n.skeleton.bones;if(d.floatVertexTextures)p=1024;else{var m=Math.min(Math.floor((d.maxVertexUniforms-20)/4),p.length);m<p.length?(console.warn('THREE.WebGLRenderer: Skeleton has '+p.length+' bones. This GPU supports '+m+'.'),p=0):p=m}}else p=0;m=d.precision;null!==b.precision&&(m=d.getMaxPrecision(b.precision),m!==b.precision&&console.warn('THREE.WebGLProgram.getParameters:',b.precision,'not supported, using',m,'instead.'));
var ba=a.getRenderTarget();return{shaderID:l,precision:m,supportsVertexTextures:d.vertexTextures,outputEncoding:u(ba?ba.texture:null,a.gammaOutput),map:!!b.map,mapEncoding:u(b.map,a.gammaInput),envMap:!!b.envMap,envMapMode:b.envMap&&b.envMap.mapping,envMapEncoding:u(b.envMap,a.gammaInput),envMapCubeUV:!!b.envMap&&(306===b.envMap.mapping||307===b.envMap.mapping),lightMap:!!b.lightMap,aoMap:!!b.aoMap,emissiveMap:!!b.emissiveMap,emissiveMapEncoding:u(b.emissiveMap,a.gammaInput),bumpMap:!!b.bumpMap,normalMap:!!b.normalMap,
displacementMap:!!b.displacementMap,roughnessMap:!!b.roughnessMap,metalnessMap:!!b.metalnessMap,specularMap:!!b.specularMap,alphaMap:!!b.alphaMap,gradientMap:!!b.gradientMap,combine:b.combine,vertexColors:b.vertexColors,fog:!!g,useFog:b.fog,fogExp:g&&g.isFogExp2,flatShading:b.flatShading,sizeAttenuation:b.sizeAttenuation,logarithmicDepthBuffer:d.logarithmicDepthBuffer,skinning:b.skinning&&0<p,maxBones:p,useVertexTexture:d.floatVertexTextures,morphTargets:b.morphTargets,morphNormals:b.morphNormals,
maxMorphTargets:a.maxMorphTargets,maxMorphNormals:a.maxMorphNormals,numDirLights:c.directional.length,numPointLights:c.point.length,numSpotLights:c.spot.length,numRectAreaLights:c.rectArea.length,numHemiLights:c.hemi.length,numClippingPlanes:h,numClipIntersection:k,dithering:b.dithering,shadowMapEnabled:a.shadowMap.enabled&&n.receiveShadow&&0<e.length,shadowMapType:a.shadowMap.type,toneMapping:a.toneMapping,physicallyCorrectLights:a.physicallyCorrectLights,premultipliedAlpha:b.premultipliedAlpha,
alphaTest:b.alphaTest,doubleSided:2===b.side,flipSided:1===b.side,depthPacking:void 0!==b.depthPacking?b.depthPacking:!1}};this.getProgramCode=function(u,b){var d=[];b.shaderID?d.push(b.shaderID):(d.push(u.fragmentShader),d.push(u.vertexShader));if(void 0!==u.defines)for(var c in u.defines)d.push(c),d.push(u.defines[c]);for(c=0;c<e.length;c++)d.push(b[e[c]]);d.push(u.onBeforeCompile.toString());d.push(a.gammaOutput);return d.join()};this.acquireProgram=function(u,d,f,e){for(var g,h=0,k=c.length;h<
k;h++){var n=c[h];if(n.code===e){g=n;++g.usedTimes;break}}void 0===g&&(g=new xa(a,b,e,u,d,f),c.push(g));return g};this.releaseProgram=function(a){if(0===--a.usedTimes){var u=c.indexOf(a);c[u]=c[c.length-1];c.pop();a.destroy()}};this.programs=c}function tb(){var a=new WeakMap;return{get:function(u){var b=a.get(u);void 0===b&&(b={},a.set(u,b));return b},remove:function(u){a.delete(u)},update:function(u,b,d){a.get(u)[b]=d},dispose:function(){a=new WeakMap}}}function zd(a,b){return a.renderOrder!==b.renderOrder?
a.renderOrder-b.renderOrder:a.program&&b.program&&a.program!==b.program?a.program.id-b.program.id:a.material.id!==b.material.id?a.material.id-b.material.id:a.z!==b.z?a.z-b.z:a.id-b.id}function Bc(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:a.id-b.id}function sc(){var a=[],b=0,d=[],c=[];return{opaque:d,transparent:c,init:function(){b=0;d.length=0;c.length=0},push:function(u,f,e,g,h){var k=a[b];void 0===k?(k={id:u.id,object:u,geometry:f,material:e,program:e.program,
renderOrder:u.renderOrder,z:g,group:h},a[b]=k):(k.id=u.id,k.object=u,k.geometry=f,k.material=e,k.program=e.program,k.renderOrder=u.renderOrder,k.z=g,k.group=h);(!0===e.transparent?c:d).push(k);b++},sort:function(){1<d.length&&d.sort(zd);1<c.length&&c.sort(Bc)}}}function Ff(){var a={};return{get:function(u,b){u=u.id+','+b.id;b=a[u];void 0===b&&(b=new sc,a[u]=b);return b},dispose:function(){a={}}}}function Va(){var a={};return{get:function(u){if(void 0!==a[u.id])return a[u.id];switch(u.type){case 'DirectionalLight':var b=
{direction:new g,color:new w,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new e};break;case 'SpotLight':b={position:new g,direction:new g,color:new w,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new e};break;case 'PointLight':b={position:new g,color:new w,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new e,shadowCameraNear:1,shadowCameraFar:1E3};break;case 'HemisphereLight':b={direction:new g,skyColor:new w,groundColor:new w};
break;case 'RectAreaLight':b={color:new w,position:new g,halfWidth:new g,halfHeight:new g}}return a[u.id]=b}}}function Gf(){var a=new Va,b={id:Ne++,hash:'',ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},d=new g,f=new c,e=new c;return{setup:function(u,c,g){var h=0,k=0,n=0,l=0,p=0,m=0,ba=0,t=0;g=g.matrixWorldInverse;for(var q=0,v=u.length;q<v;q++){var r=
u[q],ka=r.color,x=r.intensity,w=r.distance,A=r.shadow&&r.shadow.map?r.shadow.map.texture:null;if(r.isAmbientLight)h+=ka.r*x,k+=ka.g*x,n+=ka.b*x;else if(r.isDirectionalLight){var H=a.get(r);H.color.copy(r.color).multiplyScalar(r.intensity);H.direction.setFromMatrixPosition(r.matrixWorld);d.setFromMatrixPosition(r.target.matrixWorld);H.direction.sub(d);H.direction.transformDirection(g);if(H.shadow=r.castShadow)ka=r.shadow,H.shadowBias=ka.bias,H.shadowRadius=ka.radius,H.shadowMapSize=ka.mapSize;b.directionalShadowMap[l]=
A;b.directionalShadowMatrix[l]=r.shadow.matrix;b.directional[l]=H;l++}else if(r.isSpotLight){H=a.get(r);H.position.setFromMatrixPosition(r.matrixWorld);H.position.applyMatrix4(g);H.color.copy(ka).multiplyScalar(x);H.distance=w;H.direction.setFromMatrixPosition(r.matrixWorld);d.setFromMatrixPosition(r.target.matrixWorld);H.direction.sub(d);H.direction.transformDirection(g);H.coneCos=Math.cos(r.angle);H.penumbraCos=Math.cos(r.angle*(1-r.penumbra));H.decay=0===r.distance?0:r.decay;if(H.shadow=r.castShadow)ka=
r.shadow,H.shadowBias=ka.bias,H.shadowRadius=ka.radius,H.shadowMapSize=ka.mapSize;b.spotShadowMap[m]=A;b.spotShadowMatrix[m]=r.shadow.matrix;b.spot[m]=H;m++}else if(r.isRectAreaLight)H=a.get(r),H.color.copy(ka).multiplyScalar(x),H.position.setFromMatrixPosition(r.matrixWorld),H.position.applyMatrix4(g),e.identity(),f.copy(r.matrixWorld),f.premultiply(g),e.extractRotation(f),H.halfWidth.set(.5*r.width,0,0),H.halfHeight.set(0,.5*r.height,0),H.halfWidth.applyMatrix4(e),H.halfHeight.applyMatrix4(e),b.rectArea[ba]=
H,ba++;else if(r.isPointLight){H=a.get(r);H.position.setFromMatrixPosition(r.matrixWorld);H.position.applyMatrix4(g);H.color.copy(r.color).multiplyScalar(r.intensity);H.distance=r.distance;H.decay=0===r.distance?0:r.decay;if(H.shadow=r.castShadow)ka=r.shadow,H.shadowBias=ka.bias,H.shadowRadius=ka.radius,H.shadowMapSize=ka.mapSize,H.shadowCameraNear=ka.camera.near,H.shadowCameraFar=ka.camera.far;b.pointShadowMap[p]=A;b.pointShadowMatrix[p]=r.shadow.matrix;b.point[p]=H;p++}else r.isHemisphereLight&&
(H=a.get(r),H.direction.setFromMatrixPosition(r.matrixWorld),H.direction.transformDirection(g),H.direction.normalize(),H.skyColor.copy(r.color).multiplyScalar(x),H.groundColor.copy(r.groundColor).multiplyScalar(x),b.hemi[t]=H,t++)}b.ambient[0]=h;b.ambient[1]=k;b.ambient[2]=n;b.directional.length=l;b.spot.length=m;b.rectArea.length=ba;b.point.length=p;b.hemi.length=t;b.hash=b.id+','+l+','+p+','+m+','+ba+','+t+','+c.length},state:b}}function se(){var a=new Gf,b=[],d=[],c=[];return{init:function(){b.length=
0;d.length=0;c.length=0},state:{lightsArray:b,shadowsArray:d,spritesArray:c,lights:a},setupLights:function(u){a.setup(b,d,u)},pushLight:function(a){b.push(a)},pushShadow:function(a){d.push(a)},pushSprite:function(a){c.push(a)}}}function Yc(){var a={};return{get:function(u,b){u=u.id+','+b.id;b=a[u];void 0===b&&(b=new se,a[u]=b);return b},dispose:function(){a={}}}}function Gb(a){T.call(this);this.type='MeshDepthMaterial';this.depthPacking=3200;this.morphTargets=this.skinning=!1;this.displacementMap=
this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=this.fog=!1;this.setValues(a)}function Ob(a){T.call(this);this.type='MeshDistanceMaterial';this.referencePosition=new g;this.nearDistance=1;this.farDistance=1E3;this.morphTargets=this.skinning=!1;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.lights=this.fog=!1;this.setValues(a)}function Zc(a,b,d){function u(u,
b,d,c,f,e){var g=u.geometry,h=q,k=u.customDepthMaterial;d&&(h=v,k=u.customDistanceMaterial);k?h=k:(k=!1,b.morphTargets&&(g&&g.isBufferGeometry?k=g.morphAttributes&&g.morphAttributes.position&&0<g.morphAttributes.position.length:g&&g.isGeometry&&(k=g.morphTargets&&0<g.morphTargets.length)),u.isSkinnedMesh&&!1===b.skinning&&console.warn('THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:',u),u=u.isSkinnedMesh&&b.skinning,g=0,k&&(g|=1),u&&(g|=2),h=h[g]);a.localClippingEnabled&&
!0===b.clipShadows&&0!==b.clippingPlanes.length&&(g=h.uuid,k=b.uuid,u=r[g],void 0===u&&(u={},r[g]=u),g=u[k],void 0===g&&(g=h.clone(),u[k]=g),h=g);h.visible=b.visible;h.wireframe=b.wireframe;h.side=null!=b.shadowSide?b.shadowSide:ka[b.side];h.clipShadows=b.clipShadows;h.clippingPlanes=b.clippingPlanes;h.clipIntersection=b.clipIntersection;h.wireframeLinewidth=b.wireframeLinewidth;h.linewidth=b.linewidth;d&&h.isMeshDistanceMaterial&&(h.referencePosition.copy(c),h.nearDistance=f,h.farDistance=e);return h}
function f(d,c,e,g){if(!1!==d.visible){if(d.layers.test(c.layers)&&(d.isMesh||d.isLine||d.isPoints)&&d.castShadow&&(!d.frustumCulled||h.intersectsObject(d))){d.modelViewMatrix.multiplyMatrices(e.matrixWorldInverse,d.matrixWorld);var k=b.update(d),n=d.material;if(Array.isArray(n))for(var l=k.groups,p=0,m=l.length;p<m;p++){var ba=l[p],q=n[ba.materialIndex];q&&q.visible&&(q=u(d,q,g,t,e.near,e.far),a.renderBufferDirect(e,null,k,q,d,ba))}else n.visible&&(q=u(d,n,g,t,e.near,e.far),a.renderBufferDirect(e,
null,k,q,d,null))}d=d.children;k=0;for(n=d.length;k<n;k++)f(d[k],c,e,g)}}var h=new x,k=new c,n=new e,m=new e(d,d),ba=new g,t=new g,q=Array(4),v=Array(4),r={},ka={0:1,1:0,2:2},w=[new g(1,0,0),new g(-1,0,0),new g(0,0,1),new g(0,0,-1),new g(0,1,0),new g(0,-1,0)],A=[new g(0,1,0),new g(0,1,0),new g(0,1,0),new g(0,1,0),new g(0,0,1),new g(0,0,-1)],H=[new l,new l,new l,new l,new l,new l];for(d=0;4!==d;++d){var z=0!==(d&1),D=0!==(d&2),y=new Gb({depthPacking:3201,morphTargets:z,skinning:D});q[d]=y;z=new Ob({morphTargets:z,
skinning:D});v[d]=z}var B=this;this.enabled=!1;this.autoUpdate=!0;this.needsUpdate=!1;this.type=1;this.render=function(u,b,d){if(!1!==B.enabled&&(!1!==B.autoUpdate||!1!==B.needsUpdate)&&0!==u.length){var c=a.state;c.disable(a.context.BLEND);c.buffers.color.setClear(1,1,1,1);c.buffers.depth.setTest(!0);c.setScissorTest(!1);for(var e,g=0,l=u.length;g<l;g++){var q=u[g];e=q.shadow;var v=q&&q.isPointLight;if(void 0===e)console.warn('THREE.WebGLShadowMap:',q,'has no shadow.');else{var r=e.camera;n.copy(e.mapSize);
n.min(m);if(v){var ka=n.x,x=n.y;H[0].set(2*ka,x,ka,x);H[1].set(0,x,ka,x);H[2].set(3*ka,x,ka,x);H[3].set(ka,x,ka,x);H[4].set(3*ka,0,ka,x);H[5].set(ka,0,ka,x);n.x*=4;n.y*=2}null===e.map&&(e.map=new p(n.x,n.y,{minFilter:1003,magFilter:1003,format:1023}),e.map.texture.name=q.name+'.shadowMap',r.updateProjectionMatrix());e.isSpotLightShadow&&e.update(q);ka=e.map;x=e.matrix;t.setFromMatrixPosition(q.matrixWorld);r.position.copy(t);v?(e=6,x.makeTranslation(-t.x,-t.y,-t.z)):(e=1,ba.setFromMatrixPosition(q.target.matrixWorld),
r.lookAt(ba),r.updateMatrixWorld(),x.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),x.multiply(r.projectionMatrix),x.multiply(r.matrixWorldInverse));a.setRenderTarget(ka);a.clear();for(q=0;q<e;q++)v&&(ba.copy(r.position),ba.add(w[q]),r.up.copy(A[q]),r.lookAt(ba),r.updateMatrixWorld(),c.viewport(H[q])),k.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),h.setFromMatrix(k),f(b,d,r,v)}}B.needsUpdate=!1}}}function Ad(a,b,d,c,f,e,g,h,k){m.call(this,a,b,d,c,f,e,g,h,k);this.needsUpdate=!0}function ig(a,
b,d,c,e){function u(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:b.id-a.id}var h,k,n,l,p,m,ba,t,q,r,v,ka,x,w,A,H,jb,z,D,y,ta,B,C=new g,ia=new f,F=new g;this.render=function(f,g,Cf){if(0!==f.length){if(void 0===ta){var ha=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),fa=new Uint16Array([0,1,2,0,2,3]);D=b.createBuffer();y=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,D);b.bufferData(b.ARRAY_BUFFER,ha,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,
y);b.bufferData(b.ELEMENT_ARRAY_BUFFER,fa,b.STATIC_DRAW);ha=b.createProgram();fa=b.createShader(b.VERTEX_SHADER);var K=b.createShader(b.FRAGMENT_SHADER);b.shaderSource(fa,['precision '+e.precision+' float;','#define SHADER_NAME SpriteMaterial\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 center;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float fogDepth;\nvoid main() {\n\tvUV = uvOffset + uv * uvScale;\n\tvec2 alignedPosition = ( position - center ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tvec4 mvPosition;\n\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\tfogDepth = - mvPosition.z;\n}'].join('\n'));
b.shaderSource(K,['precision '+e.precision+' float;','#define SHADER_NAME SpriteMaterial\nuniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvarying float fogDepth;\nvoid main() {\n\tvec4 texture = texture2D( map, vUV );\n\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\n\tif ( gl_FragColor.a < alphaTest ) discard;\n\tif ( fogType > 0 ) {\n\t\tfloat fogFactor = 0.0;\n\t\tif ( fogType == 1 ) {\n\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t\t} else {\n\t\t\tconst float LOG2 = 1.442695;\n\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );\n\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n\t\t}\n\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n\t}\n}'].join('\n'));
b.compileShader(fa);b.compileShader(K);b.attachShader(ha,fa);b.attachShader(ha,K);b.linkProgram(ha);ta=ha;jb=b.getAttribLocation(ta,'position');z=b.getAttribLocation(ta,'uv');h=b.getUniformLocation(ta,'uvOffset');k=b.getUniformLocation(ta,'uvScale');n=b.getUniformLocation(ta,'rotation');l=b.getUniformLocation(ta,'center');p=b.getUniformLocation(ta,'scale');m=b.getUniformLocation(ta,'color');ba=b.getUniformLocation(ta,'map');t=b.getUniformLocation(ta,'opacity');q=b.getUniformLocation(ta,'modelViewMatrix');
r=b.getUniformLocation(ta,'projectionMatrix');v=b.getUniformLocation(ta,'fogType');ka=b.getUniformLocation(ta,'fogDensity');x=b.getUniformLocation(ta,'fogNear');w=b.getUniformLocation(ta,'fogFar');A=b.getUniformLocation(ta,'fogColor');b.getUniformLocation(ta,'fogDepth');H=b.getUniformLocation(ta,'alphaTest');ha=document.createElementNS('http://www.w3.org/1999/xhtml','canvas');ha.width=8;ha.height=8;fa=ha.getContext('2d');fa.fillStyle='white';fa.fillRect(0,0,8,8);B=new Ad(ha)}d.useProgram(ta);d.initAttributes();
d.enableAttribute(jb);d.enableAttribute(z);d.disableUnusedAttributes();d.disable(b.CULL_FACE);d.enable(b.BLEND);b.bindBuffer(b.ARRAY_BUFFER,D);b.vertexAttribPointer(jb,2,b.FLOAT,!1,16,0);b.vertexAttribPointer(z,2,b.FLOAT,!1,16,8);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,y);b.uniformMatrix4fv(r,!1,Cf.projectionMatrix.elements